<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="AutoIt, AutoIt3, Helpdesk, 自动化, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="AutoIt3开发Helpdesk自动化工具之三:系统配置 : blog.mingguilu.com"/>
<meta property="og:site_name" content="minggui lu"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-04-23"/>
<meta property="article:modified_time" content="2017-04-23"/>



<meta property="article:tag" content="AutoIt">
<meta property="article:tag" content="AutoIt3">
<meta property="article:tag" content="Helpdesk">
<meta property="article:tag" content="自动化">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@imkind0214">
<meta name="twitter:title" content="AutoIt3开发Helpdesk自动化工具之三:系统配置 : blog.mingguilu.com">
<meta name="twitter:creator" content="@imkind0214">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="blog.mingguilu.com">


    <base href="http://blog.mingguilu.com">
    <title> AutoIt3开发Helpdesk自动化工具之三:系统配置 - MingguiLu </title>
    <link rel="canonical" href="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/">
    

    <link href='http://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/static/css/style.css">
<link rel="stylesheet" id="font-awesome-css" href="/static/fonts/font-awesome.min.css" type="text/css" media="all"/>








    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    
  	<script src="http://blog.mingguilu.comstatic/js/highlight.pack.js"></script>
  	<link rel="stylesheet" href="http://blog.mingguilu.comstatic/css/highlight/github.css">
  	<script>hljs.initHighlightingOnLoad();</script>

    
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3d1fd52b11dc0bde2abdc4760452f3dc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-86857821-1', 'auto');
      ga('send', 'pageview');
    </script>

</head>

<body lang="en" itemscope itemtype="http://schema.org/Article">
<header id="header">
    <figure>
      <a href="/" border=0 id="logolink">
        <img id="logo-img" src="/static/img/mingguilu.jpg">
        
      </a>
    </figure>
    <div id="byline">ＭingguiLu Blog</div>
    <nav id="nav">
            <ul id="mainnav">
            <li>
                <a href="/感/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> 感 </span>
            </a>
            </li>
            <li>
            <a href="/猿/">
                <span class="icon"> <i aria-hidden="true" class="icon-code"></i></span>
                <span> 猿 </span>
            </a>
            </li>
            <li>
            <a href="/狮/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
                <span> 狮 </span>
            </a>
            </li>
            <li>
            <a href="/about/index.html">
                <span class="icon"> <i aria-hidden="true" class="icon-user"></i></span>
                <span> 吾 </span>
            </a>
            </li>
        </ul>

    

        <ul id="social">
            
            <li id="follow">
                <span class="icon icon-heart-2"> </span>
                <span class="title"> 驻留 </span>
                <div class="dropdown follow">
                    <ul class="social">
                        <li> <a href="http://github.com/mingguilu" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                        <li> <a href="http://weibo.com/kind0214" target="_blank" title="Weibo" class="github"><span class="fa fa-weibo weibo"></span>Weibo</a> </li>
                        <li> <a href="http://www.facebook.com/kind0214" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                        <li> <a href="http://www.twitter.com/kind0214" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                        
                    </ul>
                    <span class="subcount icon-arrow-right"></span>
                </div>
            </li>

            <li id="friendlink">
                <span class="icon icon-heart-2"> </span>
                <span class="title"> 友链 </span>
                <div class="dropdown friendlink">
                    <ul class="social">
                        <li> <a href="http://spf13.com/" target="_blank" title="Hacking Management" class="facebook">spf13.com</a> </li>
                        <li> <a href="http://coderzh.com/" target="_blank" title="CoderZh Blog" class="twitter">coderzh.com</a> </li>
                        <li> <a href="https://didadandan.github.io" target="_blank" title="DidaDandan Blog" class="linkedin">DidaDandan</a> </li>
                        <li> <a href="https://longlizl.github.io/" target="_blank" title="LongLi Blog" class="facebook">LongLi</a> </li>
                    </ul>
                    <a href="https://simpleprogrammer.com/" target="_blank" title="simpleprogrammer" class="rss">simpleprogrammer.com</a>
                    <span class="subcount icon-arrow-right"></span>
                </div>
            </li>

        </ul>

    
        <ul id="social">
            <li id="reading">
                <span class="icon icon-idea"> </span>
                <span class="title"> 我正在读... </span>
                <div class="dropdown reading">
                    <img src="/media/reading/3.菜鸟侦探挑战数据分析.jpg">
                    <span class="subcount icon-arrow-right"></span>
                </div>
            </li>
        </ul>

    <div id="advertise" class="dropdown follow">
    <a href="http://my.yizhihongxing.com/aff.php?aff=294" target="_blank" ><img src="/media/yzhx_232_215.jpg"></a>
</div>

    </nav>
</header>



<section id="main">
  <h1 itemprop="name" id="title">AutoIt3开发Helpdesk自动化工具之三:系统配置</h1>
  

<aside id="meta">

    <div>
        <section id="datecount">
          <h4 id="date"> Sun Apr 23, 2017 </h4>
          <h5 id="wc"> 300 Words </h5>
          <h5 id="readtime"> Read in about 2 Min </h5>
        </section>
        <ul id="categories">
          
        </ul>
        <ul id="tags">
          
            <li> <a href="http://blog.mingguilu.com/tags/autoit">AutoIt</a> </li>
          
            <li> <a href="http://blog.mingguilu.com/tags/autoit3">AutoIt3</a> </li>
          
            <li> <a href="http://blog.mingguilu.com/tags/helpdesk">Helpdesk</a> </li>
          
            <li> <a href="http://blog.mingguilu.com/tags/%E8%87%AA%E5%8A%A8%E5%8C%96">自动化</a> </li>
          
        </ul>
    </div>




</aside>

<meta itemprop="wordCount" content="287">
<meta itemprop="datePublished" content="2017-04-23">
<meta itemprop="url" content="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/">

  <div>
        <article itemprop="articleBody" id="content">
           

<p>本章将结合示例，演示如何编写自动配置系统的脚本</p>

<h3 id="一-修改administrator密码:c9ffc739bb4ddbbc027821a37c325092">一、修改administrator密码</h3>

<pre><code>#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    修改Administrator密码.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

;;定义变量用于存储administrator的密码
Global $administratorPassword = &quot;Root@1024&quot;

;;如果当前为管理员即可重设密码，如果为普通用户弹出警告提示
If IsAdmin() Then
   Run(&quot;net user administrator &quot; &amp; $administratorPassword)
   SLEEP(500)
Else
   MsgBox(64,&quot;警告&quot;,&quot;当前用户无权操作administrator密码，请切换其它管理员帐户操作！&quot;)
   SLEEP(500)
EndIf

; Script End
</code></pre>

<h3 id="二-创建普通用户admin:c9ffc739bb4ddbbc027821a37c325092">二、创建普通用户Admin</h3>

<p>当电脑在外网或脱域、administrator密码被篡改或不便告知用户、用户忘记了域账户的登录密码等极端情况下，无法登录到桌面时，可使用admin用户登录到桌面后运行远程协助软件</p>

<p><img src="/media/170423_01_02_01.jpg" alt="" /></p>

<pre><code> #cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    创建普通用户admin

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

If IsAdmin() Then
   ;;创建用户admin,密码设置为:abc@123
   Run(&quot;net user admin abc@123 /add&quot;)
   ;;将用户admin添加到本地组users中
   Run(&quot;net localgroup users admin /add&quot;)
   ;;打开计算机管理控制台
   ShellExecute(@SystemDir &amp; &quot;\compmgmt.msc&quot;)
   WinWaitActive(&quot;计算机管理&quot;,&quot;计算机管理(本地)&quot;)
   ;;暂停脚本半秒钟
   SLEEP(500)
   ;;按下方向键下键
   Send(&quot;{DOWN}&quot;,5)
   SLEEP(500)
   Send(&quot;{DOWN}&quot;)
   SLEEP(500)
   Send(&quot;{DOWN}&quot;)
   SLEEP(500)
   Send(&quot;{DOWN}&quot;)
   SLEEP(500)
   Send(&quot;{DOWN}&quot;)
   SLEEP(500)
   ;;按下方向键右键
   Send(&quot;{RIGHT}&quot;)
   SLEEP(500)
   Send(&quot;{DOWN}&quot;)
   SLEEP(500)
   ;;按下Tab键
   Send(&quot;{TAB}&quot;)
   SLEEP(500)
   ;;按下回车键
   Send(&quot;{ENTER}&quot;)
   WinWaitActive(&quot;admin 属性&quot;,&quot;常规&quot;)
   SLEEP(500)
   ;;选中“用户不能更改密码”
   ControlCommand(&quot;admin 属性&quot;,&quot;常规&quot;,&quot;Button2&quot;,&quot;Check&quot;,&quot;&quot;)
   SLEEP(500)
   ;;选中“密码永不过期”
   ControlCommand(&quot;admin 属性&quot;,&quot;常规&quot;,&quot;Button3&quot;,&quot;Check&quot;,&quot;&quot;)
   SLEEP(500)
   ;;点击“确定”
   ControlClick(&quot;admin 属性&quot;,&quot;常规&quot;,&quot;Button6&quot;,&quot;left&quot;,1)
   WinActivate(&quot;计算机管理&quot;,&quot;计算机管理(本地)&quot;)
   WinWaitActive(&quot;计算机管理&quot;,&quot;计算机管理(本地)&quot;)
   SLEEP(500)
   WinClose(&quot;计算机管理&quot;,&quot;计算机管理(本地)&quot;)
   WinWaitClose(&quot;计算机管理&quot;,&quot;计算机管理(本地)&quot;)
Else
   MsgBox(64,&quot;警告&quot;,&quot;当前用户无权操作用户和组，请切换其它管理员帐户操作！&quot;)
EndIf

; Script End   
</code></pre>

<h3 id="三-修改计算机名并加域:c9ffc739bb4ddbbc027821a37c325092">三、修改计算机名并加域</h3>

<p>当开始运行脚本时，弹出一个交互窗口用于输入计算机名，并存储到变量中以便之后调用。</p>

<pre><code>#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    修改计算机名并加域.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

Global $administratorUserName = &quot;administrator&quot;
Global $administratorPassword = &quot;Root@1024&quot;

;;定义变量$domainName存储域名
Global $domainName = &quot;awesomeit.com&quot;
;;定义变量$itUserName存储IT的账户
Global $itUserName = &quot;mingguilu&quot;
;;定义变量$itPassword存储IT的密码
Global $itPassword = &quot;Password@1024&quot;
</code></pre>

<p><img src="/media/170423_01_03_01.jpg" alt="" /></p>

<pre><code>;;定义变量$hostName存储用户交互中输入的计算机名
Global $hostName
Global $hostName = InputBox(&quot;输入&quot;,&quot;请输入计算机名：&quot;,&quot;&quot;)
</code></pre>

<p><img src="/media/170423_01_03_02.jpg" alt="" /></p>

<pre><code>If IsAdmin() Then
   ;;打开系统属性控制台
   Run(&quot;control sysdm.cpl&quot;)
Else
   ;;以管理员模式打开系统属性控制台
   RunAs($administratorUserName,@ComputerName,$administratorPassword,0,&quot;control sysdm.cpl&quot;)
EndIf
WinWaitActive(&quot;系统属性&quot;,&quot;计算机名&quot;)
SLEEP(500)
;;进入“更改”
Send(&quot;!c&quot;)
</code></pre>

<p><img src="/media/170423_01_03_03.jpg" alt="" /></p>

<pre><code>WinWaitActive(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;)
SLEEP(500)
WinActivate(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;)
;;自动填写计算机名
ControlSetText(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;,&quot;Edit1&quot;,$hostName)
SLEEP(500)
;;选中“域（D）”
ControlCommand(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;,&quot;Button3&quot;,&quot;Check&quot;)
SLEEP(500)
;;自动填写域名
ControlSetText(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;,&quot;Edit3&quot;,$domainName)
SLEEP(500)
;;点击“确定”
ControlClick(&quot;计算机名/域更改&quot;,&quot;计算机名(&amp;C):&quot;,&quot;Button6&quot;,&quot;left&quot;,1)
</code></pre>

<p><img src="/media/170423_01_03_04.jpg" alt="" /></p>

<pre><code>WinWaitActive(&quot;Windows 安全&quot;)
SLEEP(500)
;;自动填写IT人员账号
ControlSetText(&quot;Windows 安全&quot;,&quot;&quot;,&quot;Edit1&quot;,$itUserName)
SLEEP(500)
;;自动填写IT人员密码
ControlSetText(&quot;Windows 安全&quot;,&quot;&quot;,&quot;Edit2&quot;,$itPassword)
SLEEP(500)
;;点击“确定”
ControlClick(&quot;Windows 安全&quot;,&quot;&quot;,&quot;Button2&quot;,&quot;left&quot;,1)
</code></pre>

<p><img src="/media/170423_01_03_05.jpg" alt="" /></p>

<pre><code>WinWaitActive(&quot;计算机名/域更改&quot;,&quot;欢迎加入 awesomeit.com 域&quot;)
SLEEP(500)
ControlClick(&quot;计算机名/域更改&quot;,&quot;欢迎加入 awesomeit.com 域&quot;,&quot;Button1&quot;,&quot;left&quot;,1) 
</code></pre>

<p>为了兼容可能弹出的提示框，使用while循环结合if条件判断，做应对的操作：如果8秒钟之内弹出“帐户名与安全标识间无任何映射完成”的提示框，则按下回车键关闭提示框并跳出循环；如果没有弹出这个提示框，则8秒之后结束循环</p>

<pre><code>Local $i = 0
    While $i &lt;= 8000
       If WinExists(&quot;计算机名/域更改&quot;,&quot;帐户名与安全标识间无任何映射完成&quot;) Then
              WinActivate(&quot;计算机名/域更改&quot;,&quot;帐户名与安全标识间无任何映射完成&quot;)
              WinWaitActive(&quot;计算机名/域更改&quot;,&quot;帐户名与安全标识间无任何映射完成&quot;)
              SLEEP(500)
              Send(&quot;{ENTER}&quot;)
              ExitLoop
       Else
              SLEEP(1000)
              $i = $i + 1000
       EndIf
WEnd
</code></pre>

<p><img src="/media/170423_01_03_06.jpg" alt="" /></p>

<pre><code>WinWaitActive(&quot;计算机名/域更改&quot;,&quot;确定&quot;)
SLEEP(500)
Send(&quot;{ENTER}&quot;)

WinWaitActive(&quot;系统属性&quot;,&quot;计算机名&quot;)
SLEEP(500)
ControlClick(&quot;系统属性&quot;,&quot;计算机名&quot;,&quot;Button3&quot;,&quot;left&quot;,1)

WinWaitActive(&quot;Microsoft Windows&quot;)
SLEEP(500)
Send(&quot;!l&quot;)
WinWaitClose(&quot;Microsoft Windows&quot;)

; Script End
</code></pre>

        </article>
  </div>
  


<aside id="prevnext">
    

    <div>
        <section id="prev">
            &nbsp;<a class="previous" href="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E5%9B%9B:%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"><i class="icon-arrow-left"></i> AutoIt3开发Helpdesk自动化工具之四:软件安装</a><br>
        </section>
        <section id="next">
            &nbsp;<a class="next" href="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%BA%8C:%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/">AutoIt3开发Helpdesk自动化工具之二:常用语法 <i class="icon-arrow-right"></i></a>
        </section>
    </div>


</aside>

<meta itemprop="wordCount" content="287">
<meta itemprop="datePublished" content="2017-04-23">
<meta itemprop="url" content="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/">

</section>



<aside id=comments>
    <div><h2> Comments </h2></div>

     

     
	<div class="ds-thread" data-thread-key="" data-title="AutoIt3开发Helpdesk自动化工具之三:系统配置" data-url="http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/"></div>
	
	
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"imkind"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0]
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
		</script>
	

</aside>

<footer>
  <p class="back_top"><a href="javascript:scroll(0,0)" target="_self"> <span class="icon icon-rocket"></span>回到顶部<span class="icon icon-rocket"></span> </a></p>
  <div>
    <p>
    &copy;2016
        <span itemprop="name">MingguiLu .</span>
        Theme by <a href="http://servergrove.com">Server Francia</a>.
        Powered by <a href="http://gohugo.io">Hugo</a>.
        Hosted by <a href="https://github.com/">Github</a>.

    </p>
  </div>
</footer>



</body>
</html>

