<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Autoit on Continuous  Delivery</title>
    <link>http://blog.mingguilu.com/tags/autoit/</link>
    <description>Recent content in Autoit on Continuous  Delivery</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <copyright>Copyright (c) 2016 - 2021, MingguiLu; all rights reserved.</copyright>
    <lastBuildDate>Thu, 27 Apr 2017 15:05:10 +0800</lastBuildDate>
    <atom:link href="http://blog.mingguilu.com/tags/autoit/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>AutoIt3开发Helpdesk自动化工具之五:多任务组合</title>
      <link>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%BA%94:%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%BB%84%E5%90%88/</link>
      <pubDate>Thu, 27 Apr 2017 15:05:10 +0800</pubDate>
      
      <guid>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%BA%94:%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%BB%84%E5%90%88/</guid>
      <description>

&lt;p&gt;前两篇示例中，分别创建了系统配置和软件安装的3个脚本，通过“Compile Script to .exe (x86/x64)”将.au3脚本转换为.exe可执行程序，之后运行对应程序即可进行自动安装配置。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;├── 修改administrator密码.au3
├── 创建admin用户.au3
├── 修改计算机名并加域.au3
├── Cisco VPN  Client.au3
├── Adobe Flash.au3
└── Linphone.au3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;但是单独使用某一个脚本的场景并不多，通常我们根据不同需要自动完成多个任务，例如&lt;/p&gt;

&lt;p&gt;呼叫中心的电话销售：&lt;/p&gt;

&lt;p&gt;修改administrator密码 + 修改计算机名并加域 + Adobe Flash + Linphone&lt;/p&gt;

&lt;p&gt;各城市门店的业务员：&lt;/p&gt;

&lt;p&gt;修改administrator密码 + 创建admin用户 + 修改计算机名并加域 + Adobe Flash + Cisco VPN Client&lt;/p&gt;

&lt;h4 id=&#34;可以通过autoit3的用户自定义函数实现多个任务的组合:632ee543b7a1eaef1b2150eb4acb0465&#34;&gt;可以通过AutoIt3的用户自定义函数实现多个任务的组合&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;将每个功能脚本定义为一个函数&lt;/li&gt;
&lt;li&gt;将所有的自定义函数放在同一个脚本&lt;/li&gt;
&lt;li&gt;通过依次调用多个函数实现多个自动化任务&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;下面看一下脚本模型&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    Helpdesk自动化配置脚本.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

_changePassword()   ;;调用函数 _changePassword()，即执行“修改administrator密码”的脚本
;_createAdmin()  ;;添加了注释符号，不会调用函数 _createAdmin()，即不执行“创建admin用户”的脚本
_joinDomain()   ;;调用函数 _joinDomain()，即执行“修改计算机名并加域”的脚本
_adobeFlash()   ;;调用函数 _adobeFlash()，即执行“Adobe Flash”的脚本
;_linPhone()    ;;添加了注释符号，不会调用函数 _linPhone()，即不执行 “Linphone”的脚本
_ciscoVpnClient()   ;;调用函数 _ciscoVpnClient()，即执行“Cisco VPN Client”的脚本


Func _changePassword()  ;;创建一个自定义函数 _changePassword()

   ;;Script “修改administrator密码”的脚本

EndFunc


Func _createAdmin()

   ;;Script “创建admin用户”的脚本

EndFunc

Func _joinDomain()

   ;;Script “修改计算机名并加域”的脚本

EndFunc

Func _adobeFlash()

   ;;Script “Adobe Flash”的脚本

EndFunc

Func _linPhone()

   ;;Script “Linphone”的脚本

EndFunc

Func _ciscoVpnClient()

   ;;Script “Cisco VPN Client”的脚本

EndFunc

; Script End
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;使用以上的脚本模型，我们可以持续维护一份脚本，优化现有的函数或者添加新的函数，需要执行不同任务组合时，拷贝一份脚本并调用相应的函数即可。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>AutoIt3开发Helpdesk自动化工具之四:软件安装</title>
      <link>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E5%9B%9B:%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/</link>
      <pubDate>Tue, 25 Apr 2017 23:14:48 +0800</pubDate>
      
      <guid>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E5%9B%9B:%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/</guid>
      <description>

&lt;p&gt;本章将结合示例，演示如何编写自动安装软件的脚本&lt;/p&gt;

&lt;p&gt;为了便于访问软件安装程序，我将所需的软件放置在共享文件夹中，并设置共享和NTFS权限为everyone可读&lt;/p&gt;

&lt;h3 id=&#34;一-安装adobe-flash-player:604f28a47967a39b8a2bb2aff9812294&#34;&gt;一、安装Adobe Flash Player&lt;/h3&gt;

&lt;p&gt;由于Adobe Flash Player的更新升级非常频繁，安装文件名称随着每次升级变更，所以将安装文件名称修改为“Adobe_flashplayer_installer.exe”，这样每当更新安装文件之后，无需修改脚本内容。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:        MingguiLu
 Script Function:
      Adobe Flash Player

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

WinMinimizeAll()

Global $administratorUserName = &amp;quot;administrator&amp;quot;
Global $administratorPassword = &amp;quot;Root@1024&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_01_01.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;If IsAdmin() Then
   Run(&amp;quot;\\wh-filesrv-01\Software\Adobe\Adobe_flashplayer_installer.exe&amp;quot;)
Else
   ;;以管理员账户运行安装软件
   RunAs($administratorUserName,@ComputerName,$administratorPassword,0,&amp;quot;\\wh-filesrv-01\Software\Adobe\Adobe_flashplayer_installer.exe&amp;quot;,&amp;quot;&amp;quot;)
EndIf
;; “”表示当前活动窗口
WinWaitActive(&amp;quot;&amp;quot;)
;;获取当前活动窗口的标题，存储到变量tempFlashTitle中
Local $tempFlashTitle = WinGetTitle(&amp;quot;&amp;quot;)
WinWaitActive($tempFlashTitle,&amp;quot;我已经阅读并同意&amp;quot;)
SLEEP(500)
;;勾选“我已经阅读并同意Flash Player 许可协议的条款。”
ControlCommand($tempFlashTitle,&amp;quot;我已经阅读并同意&amp;quot;,&amp;quot;Button4&amp;quot;,&amp;quot;Check&amp;quot;,&amp;quot;&amp;quot;)
SLEEP(500)
;;点击“安装”
ControlClick($tempFlashTitle,&amp;quot;我已经阅读并同意&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Adobe Flash Player安装程序和IE浏览器会冲突，导致安装过程中会报错，需要使用if条件判断语句处理报错窗口&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_01_02.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;&amp;quot;)
;;获取当前活动窗口的文本，存储到变量tempFlashText中
Local $tempFlashText = WinGetText(&amp;quot;&amp;quot;)
;;如果窗口文本中包含“下列发生冲突的应用程序”字段，则点击“确定”关闭窗口
If StringInStr($tempFlashText,&amp;quot;下列发生冲突的应用程序&amp;quot;) Then
   SLEEP(500)
   ControlClick($tempFlashTitle,&amp;quot;下列发生冲突的应用程序&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_01_03.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   ;;弹出消息框提示用户，2秒后自动消失
   MsgBox(64,&amp;quot;提示&amp;quot;,&amp;quot;请关闭IE浏览器后再尝试运行安装程序！&amp;quot;,2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_01_04.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Else
   ;;等待安装完成
   WinWaitActive($tempFlashTitle,&amp;quot;Flash Player&amp;quot;)
   SLEEP(500)
   ;;点击“确定”关闭窗口
   ControlClick($tempFlashTitle,&amp;quot;Flash Player&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;left&amp;quot;,1)
   WinWaitClose($tempFlashTitle,&amp;quot;Flash Player&amp;quot;)
EndIf

; Script End
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;二-安装linphone:604f28a47967a39b8a2bb2aff9812294&#34;&gt;二、安装linphone&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:        MingguiLu
 Script Function:
    Linphone

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

WinMinimizeAll()

Global $administratorUserName = &amp;quot;administrator&amp;quot;
Global $administratorPassword = &amp;quot;Root@1024&amp;quot;

If IsAdmin() Then
   Run(&amp;quot;\\wh-filesrv-01\Software\Linphone\Linphone-3.10.2-win32.exe&amp;quot;)
Else
   RunAs($administratorUserName,@ComputerName,$administratorPassword,0,&amp;quot;\\wh-filesrv-01\Software\Linphone\Linphone-3.10.2-win32.exe&amp;quot;,&amp;quot;&amp;quot;)
EndIf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_01.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;&amp;quot;)
;;获取当前活动窗口的文本，存储到变量tempLinphoneText中
Local $tempLinphoneText = WinGetText(&amp;quot;&amp;quot;)
;;判断字符“installed”是否包含在当前活动窗口文本中，并将结果存储在变量tempResult中
Local $tempResult = StringInStr($tempLinphoneText,&amp;quot;installed&amp;quot;,0,1)
;;如果tempResult为True，表示Linphone已安装，可结束安装程序
If $tempResult Then
   WinActivate(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;Linphone is already installed&amp;quot;)
   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;Linphone is already installed&amp;quot;)
   SLEEP(500)
   ;;点击“取消”
   ControlClick(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;Linphone is already installed&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;left&amp;quot;,1)
   WinWaitClose(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;Linphone is already installed&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_02.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;;如果tempResult为False，表示Linphone未安装，可继续完成安装
Else
   WinActivate(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;欢迎使用“Linphone 3.10.2”安装向导&amp;quot;)
   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;欢迎使用“Linphone 3.10.2”安装向导&amp;quot;)
   SLEEP(500)
   ;;点击“下一步（N）”
   Send(&amp;quot;!n&amp;quot;)
   SLEEP(500)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_03.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;许可证协议&amp;quot;)
   SLEEP(500)
   ;;点击“我接受（I）”
   Send(&amp;quot;!i&amp;quot;)
   SLEEP(500)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_04.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;选择安装位置&amp;quot;)
   SLEEP(500)
   ;;点击“下一步（N）”
   Send(&amp;quot;!n&amp;quot;)
   SLEEP(500)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_05.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&#39;选择“开始菜单”文件夹&#39;)
   SLEEP(500)
   ;;点击“下一步（N）”
   Send(&amp;quot;!n&amp;quot;)
   SLEEP(500)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_06.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&amp;quot;选择组件&amp;quot;)
   SLEEP(500)
   ;;按下方向键下
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   ;;按下空格键，选中“Cisco&#39;S OpenH264 Codec”
   Send(&amp;quot;{SPACE}&amp;quot;)
   SLEEP(500)
   ;;点击“安装（I）”
   Send(&amp;quot;!i&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_02_07.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&#39;正在完成“Linphone 3.10.2”安装向导&#39;)
   SLEEP(1000)
   ;;点击“完成（F）”
   Send(&amp;quot;!f&amp;quot;)
   WinWaitClose(&amp;quot;Linphone 3.10.2 安装&amp;quot;,&#39;正在完成“Linphone 3.10.2”安装向导&#39;)
EndIf

; Script End
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;三-安装cisco-vpn-client:604f28a47967a39b8a2bb2aff9812294&#34;&gt;三、安装Cisco VPN Client&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
      Cisco VPN Client


#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

Global $administratorUserName = &amp;quot;administrator&amp;quot;
Global $administratorPassword = &amp;quot;Root@1024&amp;quot;

If IsAdmin() Then
   Run(&amp;quot;\\wh-filesrv-01\Software\Cisco\Cisco.VPN.Client.v5.0.07.0290.x64\setup.exe&amp;quot;)
Else
   RunAs($administratorUserName,@ComputerName,$administratorPassword,0,&amp;quot;\\wh-filesrv-01\Software\Cisco\Cisco.VPN.Client.v5.0.07.0290.x64\setup.exe&amp;quot;,&amp;quot;&amp;quot;)
EndIf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_01.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;WinZip Self-Extractor - setup.exe&amp;quot;,&amp;quot;To unzip all files in setup.exe&amp;quot;)
SLEEP(500)
ControlClick(&amp;quot;WinZip Self-Extractor - setup.exe&amp;quot;,&amp;quot;To unzip all files in setup.exe&amp;quot;,&amp;quot;Button4&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_02.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;WinZip Self-Extractor&amp;quot;,&amp;quot;确定&amp;quot;)
SLEEP(500)
ControlClick(&amp;quot;WinZip Self-Extractor&amp;quot;,&amp;quot;确定&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_03.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290&amp;quot;,&amp;quot;This installation can be displayed in multiple languages&amp;quot;)
SLEEP(500)
ControlClick(&amp;quot;Cisco Systems VPN Client 5.0.07.0290&amp;quot;,&amp;quot;This installation can be displayed in multiple languages&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
SLEEP(1000)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;如果已安装过Cisco VPN Client软件，再重复安装，将会有下图所示的报错窗口，需要使用if条件判断语句处理报错窗口&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_09.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;;如果存在标题为“Installer informaton”,文本内容包含&amp;quot;Error 28000:&amp;quot;的活动窗口，说明该软件已安装，可结束安装程序
If WinExists(&amp;quot;Installer Information&amp;quot;,&amp;quot;Error 28000:&amp;quot;) Then
   WinActivate(&amp;quot;Installer Information&amp;quot;,&amp;quot;Error 28000: Before installing the Cisco Systems VPN Client 5.0.07.0290&amp;quot;)
   WinWaitActive(&amp;quot;Installer Information&amp;quot;,&amp;quot;Error 28000: Before installing the Cisco Systems VPN Client 5.0.07.0290&amp;quot;)
   SLEEP(500)
   ControlClick(&amp;quot;Installer Information&amp;quot;,&amp;quot;Error 28000: Before installing the Cisco Systems VPN Client 5.0.07.0290&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_10.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Fatal Error&amp;quot;,&amp;quot;Installation ended prematurely because of an error&amp;quot;)
   SLEEP(500)
   ControlClick(&amp;quot;Fatal Error&amp;quot;,&amp;quot;Installation ended prematurely because of an error&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
   WinWaitClose(&amp;quot;Fatal Error&amp;quot;,&amp;quot;Installation ended prematurely because of an error&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_04.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Else
   WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;Welcome to the Cisco Systems VPN Client&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;!n&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_05.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;License Agreemen&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;!a&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;!n&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_06.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;Destination Folder&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;!n&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_07.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;Ready to Install the Application&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;!n&amp;quot;)
   SLEEP(500)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170425_01_03_08.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   WinWaitActive(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;successfully installed&amp;quot;)
   ;;将vpn客户端配置文件拷贝到“C:\Program Files (x86)\Cisco Systems\VPN Client\Profiles”下
   FileCopy(&amp;quot;\\wh-mingguilu-01\Installers\Cisco\Cisco.VPN.Client.v5.0.07.0290.x64\quark-IDC.pcf&amp;quot;,&amp;quot;C:\Program Files (x86)\Cisco Systems\VPN Client\Profiles&amp;quot;,1)
   SLEEP(500)
   ;;点击“Finish”关闭窗口
   ControlClick(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;successfully installed&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1)
   ;;点击“Finish”关闭窗口可能弹出标题为“Installer Information”的提示框口，也可能没有，需要使用if条件判断语句处理报错窗口
   If WinExists(&amp;quot;Installer Information&amp;quot;) Then
      WinActivate(&amp;quot;Installer Information&amp;quot;,&amp;quot;You must restart your system&amp;quot;)
      WinWaitActive(&amp;quot;Installer Information&amp;quot;,&amp;quot;You must restart your system&amp;quot;)
      SLEEP(500)
      ControlClick(&amp;quot;Installer Information&amp;quot;,&amp;quot;You must restart your system&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;left&amp;quot;,1)
      WinWaitClose(&amp;quot;Installer Information&amp;quot;,&amp;quot;You must restart your system&amp;quot;)
   Else
      WinWaitClose(&amp;quot;Cisco Systems VPN Client 5.0.07.0290 Setup&amp;quot;,&amp;quot;successfully installed&amp;quot;)
   EndIf
EndIf

; Script End
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>AutoIt3开发Helpdesk自动化工具之三:系统配置</title>
      <link>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/</link>
      <pubDate>Sun, 23 Apr 2017 14:55:43 +0800</pubDate>
      
      <guid>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%89:%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/</guid>
      <description>

&lt;p&gt;本章将结合示例，演示如何编写自动配置系统的脚本&lt;/p&gt;

&lt;h3 id=&#34;一-修改administrator密码:c9ffc739bb4ddbbc027821a37c325092&#34;&gt;一、修改administrator密码&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    修改Administrator密码.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

;;定义变量用于存储administrator的密码
Global $administratorPassword = &amp;quot;Root@1024&amp;quot;

;;如果当前为管理员即可重设密码，如果为普通用户弹出警告提示
If IsAdmin() Then
   Run(&amp;quot;net user administrator &amp;quot; &amp;amp; $administratorPassword)
   SLEEP(500)
Else
   MsgBox(64,&amp;quot;警告&amp;quot;,&amp;quot;当前用户无权操作administrator密码，请切换其它管理员帐户操作！&amp;quot;)
   SLEEP(500)
EndIf

; Script End
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;二-创建普通用户admin:c9ffc739bb4ddbbc027821a37c325092&#34;&gt;二、创建普通用户Admin&lt;/h3&gt;

&lt;p&gt;当电脑在外网或脱域、administrator密码被篡改或不便告知用户、用户忘记了域账户的登录密码等极端情况下，无法登录到桌面时，可使用admin用户登录到桌面后运行远程协助软件&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_02_01.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; #cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    创建普通用户admin

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

If IsAdmin() Then
   ;;创建用户admin,密码设置为:abc@123
   Run(&amp;quot;net user admin abc@123 /add&amp;quot;)
   ;;将用户admin添加到本地组users中
   Run(&amp;quot;net localgroup users admin /add&amp;quot;)
   ;;打开计算机管理控制台
   ShellExecute(@SystemDir &amp;amp; &amp;quot;\compmgmt.msc&amp;quot;)
   WinWaitActive(&amp;quot;计算机管理&amp;quot;,&amp;quot;计算机管理(本地)&amp;quot;)
   ;;暂停脚本半秒钟
   SLEEP(500)
   ;;按下方向键下键
   Send(&amp;quot;{DOWN}&amp;quot;,5)
   SLEEP(500)
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   ;;按下方向键右键
   Send(&amp;quot;{RIGHT}&amp;quot;)
   SLEEP(500)
   Send(&amp;quot;{DOWN}&amp;quot;)
   SLEEP(500)
   ;;按下Tab键
   Send(&amp;quot;{TAB}&amp;quot;)
   SLEEP(500)
   ;;按下回车键
   Send(&amp;quot;{ENTER}&amp;quot;)
   WinWaitActive(&amp;quot;admin 属性&amp;quot;,&amp;quot;常规&amp;quot;)
   SLEEP(500)
   ;;选中“用户不能更改密码”
   ControlCommand(&amp;quot;admin 属性&amp;quot;,&amp;quot;常规&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;Check&amp;quot;,&amp;quot;&amp;quot;)
   SLEEP(500)
   ;;选中“密码永不过期”
   ControlCommand(&amp;quot;admin 属性&amp;quot;,&amp;quot;常规&amp;quot;,&amp;quot;Button3&amp;quot;,&amp;quot;Check&amp;quot;,&amp;quot;&amp;quot;)
   SLEEP(500)
   ;;点击“确定”
   ControlClick(&amp;quot;admin 属性&amp;quot;,&amp;quot;常规&amp;quot;,&amp;quot;Button6&amp;quot;,&amp;quot;left&amp;quot;,1)
   WinActivate(&amp;quot;计算机管理&amp;quot;,&amp;quot;计算机管理(本地)&amp;quot;)
   WinWaitActive(&amp;quot;计算机管理&amp;quot;,&amp;quot;计算机管理(本地)&amp;quot;)
   SLEEP(500)
   WinClose(&amp;quot;计算机管理&amp;quot;,&amp;quot;计算机管理(本地)&amp;quot;)
   WinWaitClose(&amp;quot;计算机管理&amp;quot;,&amp;quot;计算机管理(本地)&amp;quot;)
Else
   MsgBox(64,&amp;quot;警告&amp;quot;,&amp;quot;当前用户无权操作用户和组，请切换其它管理员帐户操作！&amp;quot;)
EndIf

; Script End   
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;三-修改计算机名并加域:c9ffc739bb4ddbbc027821a37c325092&#34;&gt;三、修改计算机名并加域&lt;/h3&gt;

&lt;p&gt;当开始运行脚本时，弹出一个交互窗口用于输入计算机名，并存储到变量中以便之后调用。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         MingguiLu

 Script Function:
    修改计算机名并加域.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here

;;最小化所有窗口
WinMinimizeAll()

Global $administratorUserName = &amp;quot;administrator&amp;quot;
Global $administratorPassword = &amp;quot;Root@1024&amp;quot;

;;定义变量$domainName存储域名
Global $domainName = &amp;quot;awesomeit.com&amp;quot;
;;定义变量$itUserName存储IT的账户
Global $itUserName = &amp;quot;mingguilu&amp;quot;
;;定义变量$itPassword存储IT的密码
Global $itPassword = &amp;quot;Password@1024&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_01.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;;定义变量$hostName存储用户交互中输入的计算机名
Global $hostName
Global $hostName = InputBox(&amp;quot;输入&amp;quot;,&amp;quot;请输入计算机名：&amp;quot;,&amp;quot;&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_02.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;If IsAdmin() Then
   ;;打开系统属性控制台
   Run(&amp;quot;control sysdm.cpl&amp;quot;)
Else
   ;;以管理员模式打开系统属性控制台
   RunAs($administratorUserName,@ComputerName,$administratorPassword,0,&amp;quot;control sysdm.cpl&amp;quot;)
EndIf
WinWaitActive(&amp;quot;系统属性&amp;quot;,&amp;quot;计算机名&amp;quot;)
SLEEP(500)
;;进入“更改”
Send(&amp;quot;!c&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_03.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;)
SLEEP(500)
WinActivate(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;)
;;自动填写计算机名
ControlSetText(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;,&amp;quot;Edit1&amp;quot;,$hostName)
SLEEP(500)
;;选中“域（D）”
ControlCommand(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;,&amp;quot;Button3&amp;quot;,&amp;quot;Check&amp;quot;)
SLEEP(500)
;;自动填写域名
ControlSetText(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;,&amp;quot;Edit3&amp;quot;,$domainName)
SLEEP(500)
;;点击“确定”
ControlClick(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;计算机名(&amp;amp;C):&amp;quot;,&amp;quot;Button6&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_04.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;Windows 安全&amp;quot;)
SLEEP(500)
;;自动填写IT人员账号
ControlSetText(&amp;quot;Windows 安全&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;Edit1&amp;quot;,$itUserName)
SLEEP(500)
;;自动填写IT人员密码
ControlSetText(&amp;quot;Windows 安全&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;Edit2&amp;quot;,$itPassword)
SLEEP(500)
;;点击“确定”
ControlClick(&amp;quot;Windows 安全&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;Button2&amp;quot;,&amp;quot;left&amp;quot;,1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_05.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;欢迎加入 awesomeit.com 域&amp;quot;)
SLEEP(500)
ControlClick(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;欢迎加入 awesomeit.com 域&amp;quot;,&amp;quot;Button1&amp;quot;,&amp;quot;left&amp;quot;,1) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;为了兼容可能弹出的提示框，使用while循环结合if条件判断，做应对的操作：如果8秒钟之内弹出“帐户名与安全标识间无任何映射完成”的提示框，则按下回车键关闭提示框并跳出循环；如果没有弹出这个提示框，则8秒之后结束循环&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Local $i = 0
    While $i &amp;lt;= 8000
       If WinExists(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;帐户名与安全标识间无任何映射完成&amp;quot;) Then
              WinActivate(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;帐户名与安全标识间无任何映射完成&amp;quot;)
              WinWaitActive(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;帐户名与安全标识间无任何映射完成&amp;quot;)
              SLEEP(500)
              Send(&amp;quot;{ENTER}&amp;quot;)
              ExitLoop
       Else
              SLEEP(1000)
              $i = $i + 1000
       EndIf
WEnd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170423_01_03_06.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinWaitActive(&amp;quot;计算机名/域更改&amp;quot;,&amp;quot;确定&amp;quot;)
SLEEP(500)
Send(&amp;quot;{ENTER}&amp;quot;)

WinWaitActive(&amp;quot;系统属性&amp;quot;,&amp;quot;计算机名&amp;quot;)
SLEEP(500)
ControlClick(&amp;quot;系统属性&amp;quot;,&amp;quot;计算机名&amp;quot;,&amp;quot;Button3&amp;quot;,&amp;quot;left&amp;quot;,1)

WinWaitActive(&amp;quot;Microsoft Windows&amp;quot;)
SLEEP(500)
Send(&amp;quot;!l&amp;quot;)
WinWaitClose(&amp;quot;Microsoft Windows&amp;quot;)

; Script End
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>AutoIt3开发Helpdesk自动化工具之二:常用语法</title>
      <link>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%BA%8C:%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/</link>
      <pubDate>Fri, 21 Apr 2017 09:11:59 +0800</pubDate>
      
      <guid>http://blog.mingguilu.com/%E7%8C%BF/AutoIt3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%BA%8C:%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/</guid>
      <description>

&lt;p&gt;在正式开始脚本工具编写之前，先熟悉一下AutoIt3常用的语法&lt;/p&gt;

&lt;h4 id=&#34;参考文档:338b28e343cf68126d23434ed1836511&#34;&gt;参考文档：&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;AutoIt3安装目录中的官方英文手册 v3.3.14.2 ： AutoIt.chm&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;AutoIt 在线手册中文版_脚本之家 v3.1.1  :  &lt;a href=&#34;http://www.jb51.net/shouce/autoit/&#34;&gt;http://www.jb51.net/shouce/autoit/&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;编辑器:338b28e343cf68126d23434ed1836511&#34;&gt;编辑器&lt;/h4&gt;

&lt;p&gt;自带的编辑器是SciTe，带有所有的语法高亮功能，同时还整合了很多AutoIt的第三方工具（比如语法错误检查和脚本整理等）&lt;/p&gt;

&lt;p&gt;AutoIt3脚本文件的后缀名是&lt;code&gt;.au3&lt;/code&gt;，在安装AutoIt软件的系统上可直接运行，在未安装的系统上需编译为&lt;code&gt;.exe&lt;/code&gt;程序。创建&lt;code&gt;.au3&lt;/code&gt;格式的脚本文件方法：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;右键 ——&amp;gt; 新建 ——&amp;gt; AutoIt v3 Script&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;建议使用这种方法，优势在于脚本会自动添加一段头注释模板：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.14.2
 Author:         myName

 Script Function:
    Template AutoIt script.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;在编辑器上 File ——&amp;gt; New、直接点击New图标、或者使用快捷键 &lt;code&gt;Ctrl + N&lt;/code&gt;，这些不会自动添加头注释&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;注释:338b28e343cf68126d23434ed1836511&#34;&gt;注释&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;单行注释  分号“;”之后的内容作为注释内容&lt;/li&gt;

&lt;li&gt;&lt;p&gt;多行注释&lt;/p&gt;

&lt;p&gt;#comments-start 注释开始，可简写为：#cs&lt;/p&gt;

&lt;p&gt;;code   脚本代码&lt;/p&gt;

&lt;p&gt;#comments-end   注释结束，可简写为：#ce&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;暂停执行脚本:338b28e343cf68126d23434ed1836511&#34;&gt;暂停执行脚本&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Sleep ( 暂停时间 )  ;暂停执行的时间以毫秒为单位，1000毫秒 = 1秒

Sleep(500)
;推荐在每次等待窗口出现之后和模拟键鼠操作控件时使用Sleep暂停执行脚本半秒钟，以优化自动任务的可视效果
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;运行外部程序:338b28e343cf68126d23434ed1836511&#34;&gt;运行外部程序&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Run ( &amp;quot;文件名&amp;quot; [, &amp;quot;工作目录&amp;quot; [, 标志]] )
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;.exe 可执行程序&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;notepad.exe&amp;rdquo;)&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE&amp;rdquo;)   ;绝对路径&lt;/p&gt;

&lt;p&gt;Run(&amp;rdquo;\\wh-filesrv-01\Installers\LinPhone\Linphone-3.10.2-win32.exe&amp;rdquo;)  ;网络共享路径&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.msi 微软格式的安装包&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;msiexec /i \\wh-filesrv-01\Installers\Synjones\二代证读验机具USB驱动\USBDrv3.0-x64.msi&amp;rdquo;)&lt;br /&gt;
;调用系统程序&lt;code&gt;msiexec.exe&lt;/code&gt;操作.msi程序， &lt;code&gt;/i&lt;/code&gt;参数表示安装&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.cpl     控制面板项&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;control sysdm.cpl&amp;rdquo;)    ;打开系统属性窗口&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.cer  证书文件&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;explorer  \\wh-filesrv-01\Installers\AD\CA.cer&amp;rdquo;) ;打开安装证书窗口&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;DOS命令&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;net user admin abc@123 /add&amp;rdquo;) ;创建本地用户admin，密码为abc@123&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;net localgroup users admin /add&amp;rdquo;) ;将本地用户admin加入users组&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;系统目录&lt;/p&gt;

&lt;p&gt;Run(&amp;ldquo;explorer &amp;rdquo; &amp;amp; @ProgramFilesDir) ;打开C:\Program Files (x86)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;以其它用户运行外部程序:338b28e343cf68126d23434ed1836511&#34;&gt;以其它用户运行外部程序&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;RunAs ( &amp;quot;用户名&amp;quot;, &amp;quot;域&amp;quot;, &amp;quot;密码&amp;quot;, 注册标志, &amp;quot;程序&amp;quot; [, &amp;quot;工作目录&amp;quot; [, 显示标志 [, 选项标志 ]]] )
;注册标志：0 - 不加载配置文件的交互式登录. 1 - 加载配置文件的交互式登录. 2 - 使用网络证书. 4 - 继承调用进程的环境, 而不是用户环境
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;以本地管理员Administrator运行&lt;/p&gt;

&lt;p&gt;Global $rootUserName = &amp;ldquo;administrator&amp;rdquo;&lt;br /&gt;
Global $rootPassword = &amp;ldquo;password@123456&amp;rdquo;&lt;br /&gt;
Local $tempUserName = @UserName&lt;/p&gt;

&lt;p&gt;RunAs($rootUserName,@ComputerName,$rootPassWord,0,&amp;rdquo;\\wh-filesrv-01\Installers\LinPhone\Linphone-3.10.2-win32.exe&amp;rdquo;,&amp;ldquo;&amp;rdquo;)&lt;/p&gt;

&lt;p&gt;RunAs($rootUserName,@ComputerName,$rootPassword,0,&amp;ldquo;net localgroup /delete  administrators &amp;rdquo; &amp;amp; $tempUserName,&amp;ldquo;&amp;rdquo;)&lt;/p&gt;

&lt;p&gt;RunAs($rootUserName,@ComputerName,$rootPassWord,0,&amp;ldquo;certutil -addstore -f Root \\wh-filesrv-01\Installers\AD\CA.cer&amp;rdquo;,&amp;ldquo;&amp;rdquo;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;使用shellexecute运行外部程序:338b28e343cf68126d23434ed1836511&#34;&gt;使用ShellExecute运行外部程序&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;ShellExecute ( &amp;quot;文件名&amp;quot; [, &amp;quot;参数&amp;quot; [, &amp;quot;工作目录&amp;quot; [, &amp;quot;动作&amp;quot; [, 显示标志]]]] )
;理论上windows能识别的文件，即双击能打开的文件，使用ShellExecute也能打开
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;.msi 微软格式的安装包&lt;/p&gt;

&lt;p&gt;ShellExecute(&amp;rdquo;\\wh-filesrv-01\Installers\Synjones\二代证读验机具USB驱动\USBDrv3.0-x64.msi&amp;rdquo;)    ;安装共享目录的.msi程序&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.msc 微软管理控制台窗口&lt;/p&gt;

&lt;p&gt;ShellExecute(@SystemDir &amp;amp; &amp;ldquo;\compmgmt.msc&amp;rdquo;)  ;打开计算机管理&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.docx、.xlsx、.pptx  Office文档&lt;/p&gt;

&lt;p&gt;ShellExecute(&amp;ldquo;test.docx&amp;rdquo;)   ;打开当前目录中的Word文件
ShellExecute(&amp;ldquo;test.xlsx&amp;rdquo;)   ;打开当前目录中的Excel文件
ShellExecute(&amp;ldquo;test.pptx&amp;rdquo;)   ;打开当前目录中的PPT文件&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;.lnk  快捷方式&lt;/p&gt;

&lt;p&gt;ShellExecute(@UserProfileDir &amp;amp; &amp;ldquo;\desktop\微信.lnk&amp;rdquo;)   ;通过快捷方式运行微信&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;窗口操作:338b28e343cf68126d23434ed1836511&#34;&gt;窗口操作&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;最小化所有窗口&lt;/p&gt;

&lt;p&gt;WinMinimizeAll()&lt;br /&gt;
;我习惯在每个任务开头加上这个函数，以便仅显示任务的活动窗口&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;等待指定窗口出现&lt;/p&gt;

&lt;p&gt;WinWait ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo; [, 超时时间]] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;激活指定的窗口&lt;/p&gt;

&lt;p&gt;WinActivate ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;等待指定的窗口被激活&lt;/p&gt;

&lt;p&gt;WinWaitActive ( &amp;ldquo;窗口标题&amp;rdquo;, [&amp;ldquo;窗口文本&amp;rdquo;], [超时时间] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;关闭指定的窗口&lt;/p&gt;

&lt;p&gt;WinClose ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;等待指定的窗口被关闭&lt;/p&gt;

&lt;p&gt;WinWaitClose ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo; [, 超时时间]] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;检查指定的窗口是否存在&lt;/p&gt;

&lt;p&gt;WinExists ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;br /&gt;
;返回值：若目标窗口确实存在则返回值为1，否则返回值为0&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;检查指定的窗口是否存在且当前被激活&lt;/p&gt;

&lt;p&gt;WinActive ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;br /&gt;
;返回值：若目标窗口确实存在并被激活了则返回1，否则返回值为0&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;获取指定窗口的完整标题名&lt;/p&gt;

&lt;p&gt;WinGetTitle ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;br /&gt;
;返回值：返回一个含有目标窗口的完整标题的字符串。若无匹配窗口则返回值为1&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;获取指定窗口中的文本&lt;/p&gt;

&lt;p&gt;WinGetText ( &amp;ldquo;窗口标题&amp;rdquo; [, &amp;ldquo;窗口文本&amp;rdquo;] )&lt;br /&gt;
;返回值：返回一个含有获得的窗口文本的字符串。若无匹配窗口则返回值为1&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;控件操作:338b28e343cf68126d23434ed1836511&#34;&gt;控件操作&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;向指定控件发送鼠标点击命令&lt;/p&gt;

&lt;p&gt;ControlClick ( &amp;ldquo;窗口标题&amp;rdquo;, &amp;ldquo;窗口文本&amp;rdquo;, &amp;ldquo;控件ID&amp;rdquo; [, 按钮] [, 点击次数]] )&lt;br /&gt;
;按钮：默认“left”，还可以是“right”、“middle”；点击次数：默认“1”&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;选中或撤销选中指定的复选/单选框&lt;/p&gt;

&lt;p&gt;ControlCommand ( &amp;ldquo;窗口标题&amp;rdquo;, &amp;ldquo;窗口文本&amp;rdquo;, 控件ID, &amp;ldquo;命令&amp;rdquo;, &amp;ldquo;选项&amp;rdquo; )&lt;br /&gt;
;命令：“Check”使目标按钮（复选框/单选框）变为选中状态 ;“UnCheck”撤销目标按钮（复选框/单选框）的选中状态&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;向指定的控件发送字符串&lt;/p&gt;

&lt;p&gt;ControlSend ( &amp;ldquo;窗口标题&amp;rdquo;, &amp;ldquo;窗口文本&amp;rdquo;, 控件ID, &amp;ldquo;字符串&amp;rdquo; [, 标志] )&lt;br /&gt;
;向控件发送指定的字符串，并追加到原有字符串后面&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;修改指定控件的文本&lt;/p&gt;

&lt;p&gt;ControlSetText( &amp;ldquo;窗口标题&amp;rdquo;, &amp;ldquo;窗口文本&amp;rdquo;, 控件ID, &amp;ldquo;新文本&amp;rdquo; )&lt;br /&gt;
;向控件发送指定的字符串，并替换原有的字符串&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;模拟键击操作:338b28e343cf68126d23434ed1836511&#34;&gt;模拟键击操作&lt;/h4&gt;

&lt;p&gt;参考文档：&lt;a href=&#34;http://www.jb51.net/shouce/autoit/AutoIt_CN/html/functions/Send.htm&#34;&gt;Send - AutoIt 在线手册中文版_脚本之家&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Send ( &amp;quot;按键&amp;quot; [, 标志] )  
;向激活窗口发送模拟键击操作

!  表示 Alt  
+ 表示 Shift  
^ 表示 Ctrl  
# 表示 Windows  

Send(&amp;quot;!y&amp;quot;)  ;按下Alt+Y键
Send(&amp;quot;^s&amp;quot;)  ;按下Ctrl+S键
Send(&amp;quot;#r&amp;quot;)  ;按下Win+R键，打开运行

Send(&amp;quot;{TAB}&amp;quot;)  ;按下Tab键  
Send(&amp;quot;+{TAB 4}&amp;quot;)  ;连续按下4次Shift+Tab键  
Send(&amp;quot;{ENTER}&amp;quot;)  ;按下回车键  
Send(&amp;quot;{SPACE}&amp;quot;)  ;按下空格键  

Send(&amp;quot;{UP}&amp;quot;)  ;方向键上  
Send(&amp;quot;{DOWN 3}&amp;quot;)  ;连续按3次方向键下  
Send(&amp;quot;{LEFT}&amp;quot;)  ;方向键左  
Send(&amp;quot;{RIGHT 5}&amp;quot;)  ;连续按5次方向键右  
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;消息框:338b28e343cf68126d23434ed1836511&#34;&gt;消息框&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;MsgBox ( 标志, &amp;quot;标题&amp;quot;, &amp;quot;文本&amp;quot; [, 超时时间] )  
;显示一个简单的对话框（可设置超时属性）

$i = 5
While $i &amp;gt; 0
   MsgBox(64, &amp;quot;测试&amp;quot;, &amp;quot;此对话框将会在&amp;quot; &amp;amp; $i &amp;amp; &amp;quot;秒后自动消失&amp;quot;,1)
   Sleep(1000)
   $i = $i - 1
WEnd
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;输入框:338b28e343cf68126d23434ed1836511&#34;&gt;输入框&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;InputBox ( &amp;quot;标题&amp;quot;, &amp;quot;提示信息&amp;quot; [, &amp;quot;默认数据&amp;quot; [, &amp;quot;密码字符&amp;quot; [, 宽度, 高度 [, 左边, 上边 [, 超时时间]]]]] )  
;显示一个输入框以供用户输入数据

$yourName = InputBox(&amp;quot;提问&amp;quot;,&amp;quot;请输入你的姓名：&amp;quot;,&amp;quot;Please enter your name&amp;quot;)
MsgBox(64,&amp;quot;欢迎&amp;quot;,&amp;quot;Wellcome, &amp;quot; &amp;amp; $yourName &amp;amp; &amp;quot; !&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;检查当前用户是否拥有管理员权限:338b28e343cf68126d23434ed1836511&#34;&gt;检查当前用户是否拥有管理员权限&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;IsAdmin()
; 返回值为 1，说明当前用户拥有管理员权限  ;返回值为0，说明用户不是管理员

If IsAdmin() Then
   MsgBox(64,&amp;quot;提示&amp;quot;,&amp;quot;当前用户为系统管理员！请继续操作！&amp;quot;)
Else
   MsgBox(64,&amp;quot;提示&amp;quot;,&amp;quot;当前用户非系统管理员！请切换管理员操作！&amp;quot;)
EndIf
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;检查某个字符串是否含有给定的子串:338b28e343cf68126d23434ed1836511&#34;&gt;检查某个字符串是否含有给定的子串&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;StringInStr ( &amp;quot;字符串&amp;quot;, &amp;quot;子串&amp;quot; [, 区分大小写 [, 出现次序]] )
;成功：返回子串的位置  ;失败：返回值为0，说明未发现匹配子串
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;尝试运行2次下面的脚本示例：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WinMinimizeAll()
Run(&amp;quot;notepad.exe&amp;quot;)
WinWaitActive(&amp;quot;无标题 - 记事本&amp;quot;)
Sleep(500)
ControlSend(&amp;quot;无标题 - 记事本&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;Edit1&amp;quot;,&amp;quot;写入一段演示的文本内容！&amp;quot;)
Sleep(500)
$tempText = WinGetText(&amp;quot;&amp;quot;)
If StringInStr($tempText,&amp;quot;一段演示&amp;quot;) Then
   MsgBox(64,&amp;quot;提示&amp;quot;,&amp;quot;文本写入成功&amp;quot;,1)
EndIf
Sleep(500)
WinClose(&amp;quot;无标题 - 记事本&amp;quot;)
WinWaitActive(&amp;quot;记事本&amp;quot;,&amp;quot;保存(&amp;amp;S)&amp;quot;)
Sleep(500)
Send(&amp;quot;!s&amp;quot;)
WinWaitActive(&amp;quot;另存为&amp;quot;,&amp;quot;命名空间树控件&amp;quot;)
Sleep(500)
ControlSetText(&amp;quot;另存为&amp;quot;,&amp;quot;命名空间树控件&amp;quot;,&amp;quot;Edit1&amp;quot;,&amp;quot;test.txt&amp;quot;)
Sleep(500)
Send(&amp;quot;!s&amp;quot;)
Sleep(500)
If WinExists(&amp;quot;确认另存为&amp;quot;) Then
   ;WinActivate(&amp;quot;确认另存为&amp;quot;)
   ;WinWaitActive(&amp;quot;确认另存为&amp;quot;)
   Send(&amp;quot;!y&amp;quot;)
EndIf   
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;操作注册表:338b28e343cf68126d23434ed1836511&#34;&gt;操作注册表&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;读取注册表指定的值&lt;/p&gt;

&lt;p&gt;RegRead ( &amp;ldquo;键名&amp;rdquo;, &amp;ldquo;值项&amp;rdquo; )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;创建一个主键、子键或值项&lt;/p&gt;

&lt;p&gt;RegWrite ( &amp;ldquo;键名&amp;rdquo; [,&amp;ldquo;值项&amp;rdquo;, &amp;ldquo;类型&amp;rdquo;, 数据] )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;从注册表中删除指定键值&lt;/p&gt;

&lt;p&gt;RegDelete ( &amp;ldquo;键名&amp;rdquo; [, &amp;ldquo;值项&amp;rdquo;] )&lt;/p&gt;

&lt;p&gt;;修改注册表实现开机自动登录：&lt;/p&gt;

&lt;p&gt;RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;AutoAdminLogon&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, &amp;ldquo;1&amp;rdquo;)&lt;br /&gt;
RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultDomainName&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, $domainName)&lt;br /&gt;
RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultUserName&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, $userName)&lt;br /&gt;
RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultPassword&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, $userPassword)&lt;/p&gt;

&lt;p&gt;;修改注册表取消开机自动登录：&lt;/p&gt;

&lt;p&gt;RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;AutoAdminLogon&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, &amp;ldquo;0&amp;rdquo;)&lt;br /&gt;
RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultDomainName&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;, &amp;ldquo;.&amp;rdquo;)&lt;br /&gt;
RegWrite(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultUserName&amp;rdquo;, &amp;ldquo;REG_SZ&amp;rdquo;,&amp;ldquo;administrator&amp;rdquo;)&lt;br /&gt;
RegDelete(&amp;ldquo;HKEY_LOCAL_MACHINE64\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;rdquo;, &amp;ldquo;DefaultPassword&amp;rdquo;)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;注意！操作注册表有一个技巧十分重要，如果是Windows x64系统，需在“HKEY_LOCAL_MACHINE”后加上“64”，否则操作会被重定向至 “HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node”&lt;/p&gt;

&lt;h4 id=&#34;关机:338b28e343cf68126d23434ed1836511&#34;&gt;关机&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;Shutdown ( 代码 )

0 = Logoff（注销）
1 = Shutdown（关机）
2 = Reboot（重启）
4 = Force（强制执行）
8 = Power down（断电）
32= Suspend（待机）
64= Hibernate（休眠）
可按需把相应数值相加。比如，要关机并断电，则应指定数值 9 （shutdown + power down = 1 + 8 = 9）
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>AutoIt3开发Helpdesk自动化工具之一:简介</title>
      <link>http://blog.mingguilu.com/%E7%8C%BF/AutoIT3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%80:%E7%AE%80%E4%BB%8B/</link>
      <pubDate>Tue, 18 Apr 2017 16:30:57 +0800</pubDate>
      
      <guid>http://blog.mingguilu.com/%E7%8C%BF/AutoIT3%E5%BC%80%E5%8F%91Helpdesk%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8B%E4%B8%80:%E7%AE%80%E4%BB%8B/</guid>
      <description>

&lt;p&gt;在员工数量较多的大中型公司，Hekpdesk工程师每天重复处理大量简单而繁琐的桌面软硬件请求和报障，这些工作大多在初期进行短暂的技术学习后，很快演变为经验积累，但再丰富的经验如果无法解放时间和双手，枯燥和疲惫一直如影随形。细想一下，有些工作场景中Helpdesk工程师像机器一样在每台PC上按照相同的流程，打开相同的窗口，安装相同的软件，设置相同的选项&amp;hellip;&amp;hellip;.听起来让人很不安？但这样的情景时常上演，比如需要给30名新员工配置办公电脑、部门需要统一安装某几款软件并进行设置、或者反过来要卸载某款软件&amp;hellip;&amp;hellip;那么何必把自己当做机器呢，电脑本身不就是一台聪明的机器吗！&lt;/p&gt;

&lt;p&gt;接下来，我们将使用AutoIt3来开发一个让电脑自己执行重复任务的自动化脚本工具，并打造一个简洁实用的图形界面。&lt;/p&gt;

&lt;h3 id=&#34;一-autoit-v3-简介-https-www-autoitscript-com-site-autoit:082ed7ddbc2103f688f62492d15086fc&#34;&gt;一、&lt;a href=&#34;https://www.autoitscript.com/site/autoit/&#34;&gt;AutoIt v3 简介&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;AutoIt v3是一种免费的基于类BASIC的脚本语言，用于自动化Windows GUI和通用脚本。 它使用模拟键盘，鼠标移动和窗口/控制操作的组合，以便以其他语言（例如VBScript和SendKeys）不可能或不可靠的方式自动执行任务。 AutoIt也非常小，独立，将运行在所有版本的Windows开箱即用，不需要烦人的“runtime”要求！&lt;/p&gt;

&lt;p&gt;AutoIt最初设计用于PC“大批量交付”情况，可靠地自动化并配置成千上万的个人电脑。 随着时间的推移，它已经成为一种强大的语言，它支持复杂的表达式，用户自定义函数，循环以及经验丰富的脚本编写期望。&lt;/p&gt;

&lt;h4 id=&#34;autoit-v3-的优秀特性:082ed7ddbc2103f688f62492d15086fc&#34;&gt;AutoIt v3 的优秀特性:&lt;/h4&gt;

&lt;p&gt;&lt;p&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;简单易学的类BASIC语法&lt;/li&gt;
&lt;li&gt;模拟按键和鼠标移动&lt;/li&gt;
&lt;li&gt;操作窗口和进程&lt;/li&gt;
&lt;li&gt;与所有标准的Windows控件进行交互&lt;/li&gt;
&lt;li&gt;脚本可以编译成独立的可执行文件&lt;/li&gt;
&lt;li&gt;创建图形用户界面（GUI）&lt;/li&gt;
&lt;li&gt;支持COM&lt;/li&gt;
&lt;li&gt;正则表达式&lt;/li&gt;
&lt;li&gt;直接调用外部DLL和Windows API函数&lt;/li&gt;
&lt;li&gt;Scriptable RunAs函数&lt;/li&gt;
&lt;li&gt;详细的帮助文件和大型社区支持论坛&lt;/li&gt;
&lt;li&gt;兼容Windows XP / Server 2003 / Vista / Windows 7 / Server 2008 / Server  2008 R2 / Windows 8 / Server 2012 R2&lt;/li&gt;
&lt;li&gt;支持Unicode和x64&lt;/li&gt;
&lt;li&gt;支持数字签名&lt;/li&gt;
&lt;li&gt;适用于Windows Vista的用户帐户控制（UAC）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;最重要的是，AutoIt将持续免费 - 但是如果你想支持在项目和网络托管上花费的时间，金钱和精力，那么你可以&lt;a href=&#34;https://www.autoitscript.com/site/donate/&#34;&gt;捐赠&lt;/a&gt;。&lt;/p&gt;

&lt;h4 id=&#34;搭建autoit-v3-脚本开发环境:082ed7ddbc2103f688f62492d15086fc&#34;&gt;搭建AutoIt v3 脚本开发环境&lt;/h4&gt;

&lt;p&gt;&lt;p&gt;
&lt;a href=&#34;https://www.autoitscript.com/site/autoit/downloads/&#34;&gt;下载AutoIt v3 开发工具&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;下载时建议选择AutoIt3完全安装程序，它包含了：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;AutoIt 脚本运行软件、文档和实例&lt;/li&gt;
&lt;li&gt;Aut2Exe - 将可执行脚本转换为独立的.exe文件&lt;/li&gt;
&lt;li&gt;AutoitX - DLL/COM control。 具体作用我也不明白，安装后该目录中存放着写.dll文件&lt;/li&gt;
&lt;li&gt;Editor - 一个删减版本的SciTE脚本编辑器&lt;/li&gt;
&lt;li&gt;Au3Info - 用于探测指定窗口的详细信息，包括窗口大小和坐标、标题和文本、控件类型和ID等&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;安装时以缺省配置安装即可，安装完成即可获得我们所需的全部环境&lt;/p&gt;

&lt;h3 id=&#34;二-项目简介:082ed7ddbc2103f688f62492d15086fc&#34;&gt;二、项目简介&lt;/h3&gt;

&lt;p&gt;接下来将使用AutoIt3开发一个“Helpdesk自动化工具”，并打造一个简洁实用的用户图形界面以便交互。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://blog.mingguilu.com/media/170419_01_02_01.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;主要用途:082ed7ddbc2103f688f62492d15086fc&#34;&gt;主要用途&lt;/h4&gt;

&lt;p&gt;用于新员工入职后电脑的自动化配置&lt;/p&gt;

&lt;h4 id=&#34;功能实现:082ed7ddbc2103f688f62492d15086fc&#34;&gt;功能实现&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;随时随地开箱即用：通过文件共享在内网每一台PC上运行本工具和软件，并兼容各种意外的情况&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;我们更希望完全实现无人值守，但这并不容易。由于AutoIt3通常使用标题和文本来等待、激活、操作窗口，所以意外窗口使得自动化过程很脆弱。管理员用户和普通用户下、软件重复安装时、电脑运行速度、甚至工具本身都可能造成意外窗口，这需要反复调试来使脚本兼容各种场景。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;自动进行多任务的组合：在图形界面上通过点击预设的操作选项和用户选项，自动勾选所需的功能模块&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;如上图，点击“驻地(含VPN)”，会自动勾选上所需的系统配置、软件安装项和自动重启系统+登录域账户选项，在点击“运行”后自动配置安装，并自动重启，自动登录用户账户；当用户帐号登陆后，再次运行工具勾选对应的“用户选项”进行outlook、skype等配置&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;自动进行系统配置： 为了实现桌面统一规范化管理或应对之后可能面临的需求&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;例如：创建一个本地用户Admin、添加IT组至本地管理员组&lt;/p&gt;

&lt;p&gt;公司在各地开设分职场，但由于员工数量较少未安排驻留的Helpdesk工程师，所有的需求和故障通过电话或远程桌面进行支持，为了应对电脑出现脱域无法登录，或本地管理员密码被爆破的情况，可以在初始配置时创建一个本地admin用户，加入users组，以便用户能顺利登录桌面提供TeamViewer远程授权；而事先将Helpdesk组加入电脑本地管理员组，可在远程到用户桌面后通过切换用户，夺回管理员权限并重置密码&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;自动进行软件安装：为了安装多个软件组合时，自动启动安装程序，自动配置选项直至安装完成&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;一般我们会将操纵系统和常用的办公软件通过MDT做统一部署，比如Office、输入法、PDF阅读器、桌面词典等，而各部门专用的业务软件则会在配置电脑时进行安装&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>